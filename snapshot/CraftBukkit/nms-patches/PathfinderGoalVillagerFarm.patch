--- a/net/minecraft/server/PathfinderGoalVillagerFarm.java
+++ b/net/minecraft/server/PathfinderGoalVillagerFarm.java
@@ -19,8 +19,8 @@
             }
 
             this.f = -1;
-            this.d = this.c.ds();
-            this.e = this.c.dr();
+            this.d = this.c.dq();
+            this.e = this.c.dp();
         }
 
         return super.a();
@@ -39,29 +39,42 @@
             IBlockData iblockdata = world.getType(blockposition);
             Block block = iblockdata.getBlock();
 
-            if (this.f == 0 && block instanceof BlockCrops && ((BlockCrops) block).z(iblockdata)) {
-                world.setAir(blockposition, true);
+            if (this.f == 0 && block instanceof BlockCrops && ((BlockCrops) block).A(iblockdata)) {
+                // CraftBukkit start
+                if (!org.bukkit.craftbukkit.event.CraftEventFactory.callEntityChangeBlockEvent(this.c, blockposition, Blocks.AIR, 0).isCancelled()) {
+                    world.setAir(blockposition, true);
+                }
+                // CraftBukkit end
             } else if (this.f == 1 && iblockdata.getMaterial() == Material.AIR) {
-                InventorySubcontainer inventorysubcontainer = this.c.do_();
+                InventorySubcontainer inventorysubcontainer = this.c.dm();
 
                 for (int i = 0; i < inventorysubcontainer.getSize(); ++i) {
                     ItemStack itemstack = inventorysubcontainer.getItem(i);
                     boolean flag = false;
 
                     if (!itemstack.isEmpty()) {
+                        // CraftBukkit start
+                        Block planted = null;
                         if (itemstack.getItem() == Items.WHEAT_SEEDS) {
-                            world.setTypeAndData(blockposition, Blocks.WHEAT.getBlockData(), 3);
+                            planted = Blocks.WHEAT;
                             flag = true;
                         } else if (itemstack.getItem() == Items.POTATO) {
-                            world.setTypeAndData(blockposition, Blocks.POTATOES.getBlockData(), 3);
+                            planted = Blocks.POTATOES;
                             flag = true;
                         } else if (itemstack.getItem() == Items.CARROT) {
-                            world.setTypeAndData(blockposition, Blocks.CARROTS.getBlockData(), 3);
+                            planted = Blocks.CARROTS;
                             flag = true;
                         } else if (itemstack.getItem() == Items.BEETROOT_SEEDS) {
-                            world.setTypeAndData(blockposition, Blocks.BEETROOT.getBlockData(), 3);
+                            planted = Blocks.BEETROOT;
                             flag = true;
                         }
+
+                        if (planted != null && !org.bukkit.craftbukkit.event.CraftEventFactory.callEntityChangeBlockEvent(this.c, blockposition, planted, 0).isCancelled()) {
+                            world.setTypeAndData(blockposition, planted.getBlockData(), 3);
+                        } else {
+                            flag = false;
+                        }
+                        // CraftBukkit end
                     }
 
                     if (flag) {
@@ -88,7 +101,7 @@
             IBlockData iblockdata = world.getType(blockposition);
 
             block = iblockdata.getBlock();
-            if (block instanceof BlockCrops && ((BlockCrops) block).z(iblockdata) && this.e && (this.f == 0 || this.f < 0)) {
+            if (block instanceof BlockCrops && ((BlockCrops) block).A(iblockdata) && this.e && (this.f == 0 || this.f < 0)) {
                 this.f = 0;
                 return true;
             }
