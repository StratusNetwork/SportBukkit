--- a/net/minecraft/server/EntityEnderPearl.java
+++ b/net/minecraft/server/EntityEnderPearl.java
@@ -1,5 +1,12 @@
 package net.minecraft.server;
 
+// CraftBukkit start
+import org.bukkit.Bukkit;
+import org.bukkit.craftbukkit.event.CraftEventFactory;
+import org.bukkit.event.entity.CreatureSpawnEvent;
+import org.bukkit.event.player.PlayerTeleportEvent;
+// CraftBukkit end
+
 public class EntityEnderPearl extends EntityProjectile {
 
     private EntityLiving d;
@@ -36,10 +43,6 @@
                 TileEntityEndGateway tileentityendgateway = (TileEntityEndGateway) tileentity;
 
                 if (entityliving != null) {
-                    if (entityliving instanceof EntityPlayer) {
-                        CriterionTriggers.d.a((EntityPlayer) entityliving, this.world.getType(blockposition));
-                    }
-
                     tileentityendgateway.a((Entity) entityliving);
                     this.die();
                     return;
@@ -59,21 +62,35 @@
                 EntityPlayer entityplayer = (EntityPlayer) entityliving;
 
                 if (entityplayer.playerConnection.a().isConnected() && entityplayer.world == this.world && !entityplayer.isSleeping()) {
-                    if (this.random.nextFloat() < 0.05F && this.world.getGameRules().getBoolean("doMobSpawning")) {
-                        EntityEndermite entityendermite = new EntityEndermite(this.world);
-
-                        entityendermite.a(true);
-                        entityendermite.setPositionRotation(entityliving.locX, entityliving.locY, entityliving.locZ, entityliving.yaw, entityliving.pitch);
-                        this.world.addEntity(entityendermite);
+                    // CraftBukkit start - Fire PlayerTeleportEvent
+                    org.bukkit.craftbukkit.entity.CraftPlayer player = entityplayer.getBukkitEntity();
+                    org.bukkit.Location location = getBukkitEntity().getLocation();
+                    location.setPitch(player.getLocation().getPitch());
+                    location.setYaw(player.getLocation().getYaw());
+
+                    PlayerTeleportEvent teleEvent = new PlayerTeleportEvent(player, player.getLocation(), location, PlayerTeleportEvent.TeleportCause.ENDER_PEARL);
+                    Bukkit.getPluginManager().callEvent(teleEvent);
+
+                    if (!teleEvent.isCancelled() && !entityplayer.playerConnection.isDisconnected()) {
+                        if (this.random.nextFloat() < 0.05F && this.world.getGameRules().getBoolean("doMobSpawning")) {
+                            EntityEndermite entityendermite = new EntityEndermite(this.world);
+
+                            entityendermite.a(true);
+                            entityendermite.setPositionRotation(entityliving.locX, entityliving.locY, entityliving.locZ, entityliving.yaw, entityliving.pitch);
+                            this.world.addEntity(entityendermite, CreatureSpawnEvent.SpawnReason.ENDER_PEARL);
+                        }
+
+                        if (entityliving.isPassenger()) {
+                            entityliving.stopRiding();
+                        }
+
+                        entityplayer.playerConnection.teleport(teleEvent.getTo());
+                        entityliving.fallDistance = 0.0F;
+                        CraftEventFactory.entityDamage = this;
+                        entityliving.damageEntity(DamageSource.FALL, 5.0F);
+                        CraftEventFactory.entityDamage = null;
                     }
-
-                    if (entityliving.isPassenger()) {
-                        entityliving.stopRiding();
-                    }
-
-                    entityliving.enderTeleportTo(this.locX, this.locY, this.locZ);
-                    entityliving.fallDistance = 0.0F;
-                    entityliving.damageEntity(DamageSource.FALL, 5.0F);
+                    // CraftBukkit end
                 }
             } else if (entityliving != null) {
                 entityliving.enderTeleportTo(this.locX, this.locY, this.locZ);
@@ -85,13 +102,13 @@
 
     }
 
-    public void B_() {
+    public void A_() {
         EntityLiving entityliving = this.getShooter();
 
         if (entityliving != null && entityliving instanceof EntityHuman && !entityliving.isAlive()) {
             this.die();
         } else {
-            super.B_();
+            super.A_();
         }
 
     }
